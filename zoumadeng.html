<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diptyque Atmosphere Demo</title>
    <style>
        :root {
            /* 更深邃、更温暖的色调 */
            --gold-light: #fff3c5;
            --gold-mid: #d4af37;
            --gold-dark: #8c7224;
            --flame-core: #ffffcc;
            --flame-outer: #ff9933;
            --bg-color: #020100; /* 几近全黑 */
            --wall-glow: radial-gradient(circle at center, rgba(255, 160, 60, 0.25) 0%, rgba(0,0,0,1) 70%);
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            perspective: 1200px; /* 加深透视感 */
        }

        /* 背景墙面的光晕 */
        .wall-illumination {
            position: absolute;
            width: 200%;
            height: 200%;
            background: var(--wall-glow);
            z-index: -2; /* 最底层 */
        }

        /* 场景总容器，用于鼠标互动倾斜 */
        .scene-wrapper {
            position: relative;
            width: 300px;
            height: 500px;
            transform-style: preserve-3d;
            transition: transform 0.1s ease-out;
        }

        /* =========================================
           影子投射层 (关键 Trick)
           它在真实物体后面，同步旋转，但更大、更模糊
        ========================================= */
        .shadow-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            z-index: -1; /* 在真实物体后面 */
            pointer-events: none;
            /* 整体后移并放大，模拟投射到远墙 */
            transform: translateZ(-200px) scale(2.5);
            filter: blur(15px); /* 关键：极度模糊产生柔和影子 */
            opacity: 0.7;
        }

        .shadow-assembly {
            position: absolute;
            top: 50px;
            left: 50%;
            transform-style: preserve-3d;
            /* 必须与实体走马灯使用相同的旋转动画 */
            animation: rotateCarousel 15s linear infinite;
        }

        .shadow-charm-shape {
            position: absolute;
            top: 0;
            left: -25px;
            width: 50px;
            height: 70px;
            background: #000; /* 纯黑影子 */
            /* 与实体吊坠相同的形状 */
            clip-path: polygon(50% 0%, 100% 30%, 80% 100%, 20% 100%, 0% 30%);
            transform-origin: top center;
             /* 影子也需要一点摆动，增加真实感 */
            animation: swingShadow 4s ease-in-out infinite alternate;
        }


        /* =========================================
           实体走马灯层
        ========================================= */
        .carousel-assembly {
            position: absolute;
            top: 50px;
            left: 50%;
            transform-style: preserve-3d;
            animation: rotateCarousel 15s linear infinite;
        }

        /* 顶部扇叶 (更精致的金属感) */
        .turbine {
            position: absolute;
            top: -15px;
            left: -70px;
            width: 140px;
            height: 140px;
            /* 金属拉丝效果 */
            background: repeating-conic-gradient(from 0deg, var(--gold-mid) 0deg 10deg, var(--gold-dark) 10deg 20deg, var(--gold-light) 20deg 30deg);
            border-radius: 50%;
            transform: rotateX(90deg);
            box-shadow: inset 0 0 20px rgba(0,0,0,0.5), 0 5px 15px rgba(0,0,0,0.3);
            border: 2px solid var(--gold-dark);
        }

        /* 吊坠容器 */
        .charm-container {
            position: absolute;
            transform-style: preserve-3d;
        }

        /* 实体吊坠 */
        .charm-real {
            position: absolute;
            top: 0;
            left: -20px;
            width: 40px;
            height: 60px;
            /* 高亮的金色材质 */
            background: linear-gradient(135deg, var(--gold-light) 0%, var(--gold-mid) 40%, var(--gold-dark) 100%);
            clip-path: polygon(50% 0%, 100% 30%, 80% 100%, 20% 100%, 0% 30%);
            transform-origin: top center;
            backface-visibility: visible;
            /* 自身发光感，因为离蜡烛很近 */
            box-shadow: 0 0 25px rgba(255, 200, 50, 0.6);
            border: 1px solid var(--gold-light);
            animation: swingReal 4s ease-in-out infinite alternate;
        }

        .string {
            position: absolute;
            top: -25px;
            left: 50%;
            width: 1px;
            height: 25px;
            background: var(--gold-light);
            opacity: 0.8;
        }


        /* =========================================
           玻璃蜡烛罐
        ========================================= */
        .candle-jar {
            position: absolute;
            bottom: 60px;
            left: 50%;
            transform: translateX(-50%);
            width: 120px;
            height: 160px;
            /* 玻璃质感：半透明白 + 模糊背景 */
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(2px);
            border-radius: 4px;
            /* 玻璃边缘反光 */
            border-left: 1px solid rgba(255,255,255,0.3);
            border-right: 1px solid rgba(255,255,255,0.3);
            box-shadow: 
                inset 0 0 30px rgba(255, 160, 60, 0.3), /* 内部烛光映照 */
                0 10px 30px rgba(0,0,0,0.5); /* 外部阴影 */
            display: flex;
            justify-content: center;
            align-items: flex-end;
            padding-bottom: 20px;
            transform-style: preserve-3d;
        }

        /* 蜡烛里的蜡 */
        .wax {
            width: 90%;
            height: 60%;
            background: linear-gradient(to bottom, #fffcf0, #f0ead6);
            border-radius: 2px;
            box-shadow: inset 0 -5px 10px rgba(0,0,0,0.1);
            position: relative;
             display: flex;
            justify-content: center;
        }

        /* 烛芯和火焰 */
        .wick {
            width: 2px;
            height: 10px;
            background: #333;
            position: absolute;
            top: -10px;
        }

        .flame {
            position: absolute;
            top: -28px;
            width: 16px;
            height: 30px;
            background: radial-gradient(ellipse at bottom, var(--flame-core) 10%, var(--flame-outer) 60%, transparent 100%);
            border-radius: 50% 50% 20% 20%;
            filter: blur(1px);
            animation: flicker 0.1s infinite alternate;
            /* 极其强烈的中心光源效果 */
            box-shadow: 
                0 0 20px 5px var(--flame-core),
                0 -10px 50px 20px var(--flame-outer),
                0 -30px 100px 40px rgba(255, 100, 0, 0.3); 
        }

        /* Diptyque 标签 */
        .label {
            position: absolute;
            top: 30%;
            left: 50%;
            transform: translate(-50%, -50%) translateZ(61px); /*稍微突出玻璃表面*/
            width: 60px;
            height: 80px;
            background: #fff;
            border: 1px solid #111;
            border-radius: 50% / 40%;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            font-family: 'Times New Roman', serif;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            backface-visibility: hidden;
        }

        /* 动画定义 */
        @keyframes rotateCarousel {
            from { transform: rotateY(0deg); }
            to { transform: rotateY(360deg); }
        }

        @keyframes swingReal {
            0% { transform: rotateX(2deg) rotateZ(-3deg); }
            100% { transform: rotateX(8deg) rotateZ(3deg); }
        }
        /* 影子的摆动幅度稍微小一点，更有层次感 */
        @keyframes swingShadow {
            0% { transform: rotateX(0deg) rotateZ(-1deg); }
            100% { transform: rotateX(4deg) rotateZ(1deg); }
        }

        @keyframes flicker {
            0% { transform: scale(1) skewX(1deg); opacity: 0.9; filter: blur(1px); }
            100% { transform: scale(1.05, 1.1) skewX(-1deg); opacity: 1; filter: blur(2px); }
        }

        .instruction {
            position: absolute;
            bottom: 20px;
            color: var(--gold-dark);
            font-family: sans-serif;
            font-size: 12px;
            opacity: 0.5;
            letter-spacing: 2px;
        }

    </style>
</head>
<body>

    <div class="wall-illumination"></div>

    <div class="scene-wrapper" id="scene">

        <div class="shadow-layer">
            <div class="shadow-assembly" id="shadow-group">
                </div>
        </div>

        <div class="carousel-assembly">
            <div class="turbine"></div>
            <div id="real-charms-group">
                </div>
        </div>

        <div class="candle-jar">
            <div class="label">
                <div style="transform: scale(0.7);">
                    Diptyque<br><span style="font-size:8px">PARIS</span><br><br>BAIES
                </div>
            </div>
            <div class="wax">
                <div class="wick"></div>
                <div class="flame"></div>
            </div>
        </div>

    </div>

    <div class="instruction">MOVE MOUSE TO INTERACT</div>

    <script>
        const realCharmsGroup = document.getElementById('real-charms-group');
        const shadowGroup = document.getElementById('shadow-group');
        const numberOfCharms = 5; // 吊坠数量
        const radius = 85; // 实体半径

        for (let i = 0; i < numberOfCharms; i++) {
            const angle = (i / numberOfCharms) * 360;
            
            // --- 1. 创建实体吊坠 ---
            const charmContainer = document.createElement('div');
            charmContainer.className = 'charm-container';
            charmContainer.style.transform = `rotateY(${angle}deg) translateZ(${radius}px)`;

            const string = document.createElement('div');
            string.className = 'string';
            
            const realCharm = document.createElement('div');
            realCharm.className = 'charm-real';

            charmContainer.appendChild(string);
            charmContainer.appendChild(realCharm);
            realCharmsGroup.appendChild(charmContainer);

            // --- 2. 创建对应的影子吊坠 ---
            // 影子的容器，位置与实体相同（但在 shadow-layer 中会被整体放大后移）
            const shadowContainer = document.createElement('div');
            shadowContainer.className = 'charm-container';
            // 这里的 translateZ 可以稍微大一点点，让影子散开得更开
            shadowContainer.style.transform = `rotateY(${angle}deg) translateZ(${radius * 1.1}px)`;

            const shadowShape = document.createElement('div');
            shadowShape.className = 'shadow-charm-shape';

            shadowContainer.appendChild(shadowShape);
            shadowGroup.appendChild(shadowContainer);
        }

        // 鼠标互动
        const scene = document.getElementById('scene');
        let targetX = 0, targetY = 0;
        let currentX = 0, currentY = 0;

        document.addEventListener('mousemove', (e) => {
            targetX = (e.clientX / window.innerWidth) * 2 - 1;
            targetY = (e.clientY / window.innerHeight) * 2 - 1;
        });

        // 使用 requestAnimationFrame 使移动更平滑
        function animateInteraction() {
            // 简单的缓动效果
            currentX += (targetX - currentX) * 0.05;
            currentY += (targetY - currentY) * 0.05;

            const rotateY = currentX * 15; 
            const rotateX = -currentY * 10;

            scene.style.transform = `rotateY(${rotateY}deg) rotateX(${rotateX}deg)`;
            requestAnimationFrame(animateInteraction);
        }
        animateInteraction();

    </script>
</body>
</html>
